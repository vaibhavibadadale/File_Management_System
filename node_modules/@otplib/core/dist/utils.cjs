"use strict";var U=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var rr=Object.prototype.hasOwnProperty;var er=(r,e)=>{for(var t in e)U(r,t,{get:e[t],enumerable:!0})},tr=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Z(e))!rr.call(r,n)&&n!==t&&U(r,n,{get:()=>e[n],enumerable:!(s=Q(e,n))||s.enumerable});return r};var nr=r=>tr(U({},"__esModule",{value:!0}),r);var Mr={};er(Mr,{DEFAULT_PERIOD:()=>z,MAX_COUNTER:()=>F,MAX_PERIOD:()=>W,MAX_SECRET_BYTES:()=>q,MAX_WINDOW:()=>V,MIN_PERIOD:()=>k,MIN_SECRET_BYTES:()=>L,RECOMMENDED_SECRET_BYTES:()=>Y,constantTimeEqual:()=>fr,counterToBytes:()=>mr,createGuardrails:()=>or,dynamicTruncate:()=>dr,generateSecret:()=>Or,getDigestSize:()=>Tr,hasGuardrailOverrides:()=>ir,hexToBytes:()=>br,normalizeCounterTolerance:()=>Ar,normalizeEpochTolerance:()=>yr,normalizeSecret:()=>hr,requireBase32Plugin:()=>X,requireBase32String:()=>_r,requireCryptoPlugin:()=>H,requireIssuer:()=>Sr,requireLabel:()=>wr,requireSecret:()=>Pr,stringToBytes:()=>N,truncateDigits:()=>Er,validateByteLengthEqual:()=>j,validateCounter:()=>ur,validateCounterTolerance:()=>xr,validateEpochTolerance:()=>gr,validatePeriod:()=>pr,validateSecret:()=>ar,validateTime:()=>cr,validateToken:()=>lr,wrapResult:()=>Rr,wrapResultAsync:()=>Ir});module.exports=nr(Mr);var o=class extends Error{constructor(e,t){super(e,t),this.name="OTPError"}},c=class extends o{constructor(e){super(e),this.name="SecretError"}},p=class extends c{constructor(e,t){super(`Secret must be at least ${e} bytes (${e*8} bits), got ${t} bytes`),this.name="SecretTooShortError"}},l=class extends c{constructor(e,t){super(`Secret must not exceed ${e} bytes, got ${t} bytes`),this.name="SecretTooLongError"}},x=class extends o{constructor(e){super(e),this.name="CounterError"}},g=class extends x{constructor(){super("Counter must be non-negative"),this.name="CounterNegativeError"}},m=class extends x{constructor(){super("Counter exceeds maximum safe integer value"),this.name="CounterOverflowError"}},v=class extends o{constructor(e){super(e),this.name="TimeError"}},d=class extends v{constructor(){super("Time must be non-negative"),this.name="TimeNegativeError"}},E=class extends o{constructor(e){super(e),this.name="PeriodError"}},f=class extends E{constructor(e){super(`Period must be at least ${e} second(s)`),this.name="PeriodTooSmallError"}},T=class extends E{constructor(e){super(`Period must not exceed ${e} seconds`),this.name="PeriodTooLargeError"}};var b=class extends o{constructor(e){super(e),this.name="TokenError"}},h=class extends b{constructor(e,t){super(`Token must be ${e} digits, got ${t}`),this.name="TokenLengthError"}},O=class extends b{constructor(){super("Token must contain only digits"),this.name="TokenFormatError"}};var D=class extends o{constructor(e){super(e),this.name="CounterToleranceError"}},A=class extends D{constructor(e,t){super(`Counter tolerance size must not exceed ${e}, got ${t}. Large tolerances can cause performance issues.`),this.name="CounterToleranceTooLargeError"}},y=class extends o{constructor(e){super(e),this.name="EpochToleranceError"}},P=class extends y{constructor(){super("Epoch tolerance cannot contain negative values"),this.name="EpochToleranceNegativeError"}},w=class extends y{constructor(e,t){super(`Epoch tolerance must not exceed ${e} seconds, got ${t}. Large tolerances can cause performance issues.`),this.name="EpochToleranceTooLargeError"}},S=class extends o{constructor(e){super(e),this.name="PluginError"}},_=class extends S{constructor(){super("Crypto plugin is required."),this.name="CryptoPluginMissingError"}},R=class extends S{constructor(){super("Base32 plugin is required."),this.name="Base32PluginMissingError"}},u=class extends o{constructor(e){super(e),this.name="ConfigurationError"}},I=class extends u{constructor(){super("Secret is required. Use generateSecret() to create one, or provide via { secret: 'YOUR_BASE32_SECRET' }"),this.name="SecretMissingError"}},M=class extends u{constructor(){super("Label is required for URI generation. Example: { label: 'user@example.com' }"),this.name="LabelMissingError"}},B=class extends u{constructor(){super("Issuer is required for URI generation. Example: { issuer: 'MyApp' }"),this.name="IssuerMissingError"}},C=class extends u{constructor(){super("Class API requires secret to be a Base32 string, not Uint8Array. Use generateSecret() or provide a Base32-encoded string."),this.name="SecretTypeError"}};var sr=new TextEncoder,L=16,q=64,Y=20,k=1,W=3600,z=30,F=Number.MAX_SAFE_INTEGER,V=100,$=Symbol("otplib.guardrails.override"),a=Object.freeze({MIN_SECRET_BYTES:L,MAX_SECRET_BYTES:q,MIN_PERIOD:k,MAX_PERIOD:W,MAX_COUNTER:F,MAX_WINDOW:V,[$]:!1});function or(r){return r?Object.freeze({...a,...r,[$]:!0}):a}function ir(r){return r[$]??!1}function ar(r,e=a){if(r.length<e.MIN_SECRET_BYTES)throw new p(e.MIN_SECRET_BYTES,r.length);if(r.length>e.MAX_SECRET_BYTES)throw new l(e.MAX_SECRET_BYTES,r.length)}function ur(r,e=a){let t=typeof r=="bigint"?r:BigInt(r);if(t<0n)throw new g;if(t>BigInt(e.MAX_COUNTER))throw new m}function cr(r){if(r<0)throw new d}function pr(r,e=a){if(!Number.isInteger(r)||r<e.MIN_PERIOD)throw new f(e.MIN_PERIOD);if(r>e.MAX_PERIOD)throw new T(e.MAX_PERIOD)}function lr(r,e){if(r.length!==e)throw new h(e,r.length);if(!/^\d+$/.test(r))throw new O}function xr(r,e=a){if((Array.isArray(r)?r.length:r*2+1)>e.MAX_WINDOW*2+1)throw new A(e.MAX_WINDOW,Array.isArray(r)?r.length:r)}function gr(r,e=z,t=a){let[s,n]=Array.isArray(r)?r:[r,r];if(s<0||n<0)throw new P;let i=t.MAX_WINDOW*e,G=Math.max(s,n);if(G>i)throw new w(i,G)}function mr(r){let e=typeof r=="bigint"?r:BigInt(r),t=new ArrayBuffer(8);return new DataView(t).setBigUint64(0,e,!1),new Uint8Array(t)}function dr(r){let e=r[r.length-1]&15;return(r[e]&127)<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}function Er(r,e){let t=10**e;return(r%t).toString().padStart(e,"0")}function j(r,e){return r.length===e.length}function fr(r,e){let t=N(r),s=N(e);if(!j(t,s))return!1;let n=0;for(let i=0;i<t.length;i++)n|=t[i]^s[i];return n===0}function Tr(r){switch(r){case"sha1":return 20;case"sha256":return 32;case"sha512":return 64}}function N(r){return typeof r=="string"?sr.encode(r):r}function br(r){let e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2)e[t/2]=parseInt(r.substring(t,t+2),16);return e}function hr(r,e){return typeof r=="string"?(X(e),e.decode(r)):r}function Or(r){let{crypto:e,base32:t,length:s=Y}=r;H(e),X(t);let n=e.randomBytes(s);return t.encode(n,{padding:!1})}function Ar(r=0){if(Array.isArray(r))return r;let e=[];for(let t=-r;t<=r;t++)e.push(t|0);return e}function yr(r=0){return Array.isArray(r)?r:[r,r]}function H(r){if(!r)throw new _}function X(r){if(!r)throw new R}function Pr(r){if(!r)throw new I}function wr(r){if(!r)throw new M}function Sr(r){if(!r)throw new B}function _r(r){if(typeof r!="string")throw new C}function J(r){return{ok:!0,value:r}}function K(r){return{ok:!1,error:r}}function Rr(r){return(...e)=>{try{return J(r(...e))}catch(t){return K(t)}}}function Ir(r){return async(...e)=>{try{return J(await r(...e))}catch(t){return K(t)}}}0&&(module.exports={DEFAULT_PERIOD,MAX_COUNTER,MAX_PERIOD,MAX_SECRET_BYTES,MAX_WINDOW,MIN_PERIOD,MIN_SECRET_BYTES,RECOMMENDED_SECRET_BYTES,constantTimeEqual,counterToBytes,createGuardrails,dynamicTruncate,generateSecret,getDigestSize,hasGuardrailOverrides,hexToBytes,normalizeCounterTolerance,normalizeEpochTolerance,normalizeSecret,requireBase32Plugin,requireBase32String,requireCryptoPlugin,requireIssuer,requireLabel,requireSecret,stringToBytes,truncateDigits,validateByteLengthEqual,validateCounter,validateCounterTolerance,validateEpochTolerance,validatePeriod,validateSecret,validateTime,validateToken,wrapResult,wrapResultAsync});
//# sourceMappingURL=utils.cjs.map